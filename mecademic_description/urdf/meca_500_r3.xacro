<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

<!--    
    MACRO to mecademic robot
    scale = unit scale, 1.0 = [m] (default 1.0)
    prefix = name to use as prefix (default '')

    the base link will be ${prefix}meca_brf
    the meca_wrf and meca_trf will be updated by the driver
-->
<xacro:macro 
    name="meca_500_r3" 
    params=" 
        scale:=1.0
        prefix:=''
        "
>

<!--
    ******************** 
    MAIN CHAIN 
    ********************
-->

<!-- Base link is the center of the robot's bottom plate -->
<link name="${prefix}base_link">
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_base.dae" 
                scale="${scale} ${scale} ${scale}"
            />
        </geometry>
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_base_collision.stl" 
                scale="${scale} ${scale} ${scale}"
            />
        </geometry>
    </collision>
</link>

<!-- Joint BASE_LINK->AXIS_1_LINK  -->
<joint name="${prefix}A1_joint" type="revolute">
    <origin xyz="${0.012498*scale} 0 ${0.091*scale}" rpy="0 0 0" />
    <parent link="${prefix}base_link" />
    <child link="${prefix}A1_link" />
    <axis xyz="0 0 1" />
    <limit effort="10.0" velocity="${150.0*pi/180.0}" lower="${-175.0*pi/180.0}" upper="${175.0*pi/180.0}" />
</joint>

<!-- AXIS_1_LINK -->
<link name="${prefix}A1_link">
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j1.dae" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j1_collision.stl" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </collision>
</link>

<!-- Joint AXIS_1_LINK->AXIS_2_LINK  -->
<joint name="${prefix}A2_joint" type="revolute">
    <origin xyz="0 0 ${0.044*scale}" rpy="0 0 0" />
    <parent link="${prefix}A1_link" />
    <child link="${prefix}A2_link" />
    <axis xyz="0 1 0" />
    <limit effort="10.0" velocity="${150.0*pi/180.0}" lower="${-70.0*pi/180.0}" upper="${90.0*pi/180.0}" />
</joint>

<!-- AXIS_2_LINK -->
<link name="${prefix}A2_link">
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j2.dae" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j2_collision.stl" 
                scale="${scale} ${scale} ${scale}"    
            />
    </geometry>
    </collision>
</link>

<!-- Joint AXIS_2_LINK->AXIS_3_LINK  -->
<joint name="${prefix}A3_joint" type="revolute">
    <origin xyz="0 0 ${0.135*scale}" rpy="0 0 0" />
    <parent link="${prefix}A2_link" />
    <child link="${prefix}A3_link" />
    <axis xyz="0 1 0" />
    <limit effort="10.0" velocity="${180.0*pi/180.0}" lower="${-135.0*pi/180.0}" upper="${70.0*pi/180.0}" />
</joint>

<!-- AXIS_3_LINK -->
<link name="${prefix}A3_link">
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j3.dae" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j3_collision.stl" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </collision>
</link>

<!-- Joint AXIS_3_LINK->AXIS_4_LINK  -->
<joint name="${prefix}A4_joint" type="revolute">
    <origin xyz="0 0 ${0.038*scale}" rpy="0 0 0" />
    <parent link="${prefix}A3_link" />
    <child link="${prefix}A4_link" />
    <axis xyz="1 0 0" />
    <limit effort="10.0" velocity="${300.0*pi/180.0}" lower="${-170.0*pi/180.0}" upper="${170.0*pi/180.0}" />
</joint>

<!-- AXIS_4_LINK -->
<link name="${prefix}A4_link">
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j4.dae" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j4_collision.stl" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </collision>
</link>

<!-- Joint AXIS_4_LINK->AXIS_5_LINK  -->
<joint name="${prefix}A5_joint" type="revolute">
    <origin xyz="${0.12*scale} 0 0" rpy="0 0 0" />
    <parent link="${prefix}A4_link" />
    <child link="${prefix}A5_link" />
    <axis xyz="0 1 0" />
    <limit effort="10.0" velocity="${300.0*pi/180.0}" lower="${-115.0*pi/180.0}" upper="${115.0*pi/180.0}" />
</joint>

<!-- AXIS_5_LINK -->
<link name="${prefix}A5_link">
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j5.dae" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j5_collision.stl" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </collision>
</link>

<!-- Joint AXIS_5_LINK->AXIS_6_LINK  -->
<joint name="${prefix}A6_joint" type="revolute">
    <origin xyz="${0.07*scale} 0 0" rpy="0 0 0" />
    <parent link="${prefix}A5_link" />
    <child link="${prefix}A6_link" />
    <axis xyz="1 0 0" />
    <limit effort="10.0" velocity="${500.0*pi/180.0}" lower="${-36000.0*pi/180.0}" upper="${36000.0*pi/180.0}" />
</joint>

<!-- AXIS_6_LINK -->
<link name="${prefix}A6_link">
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j6.dae" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <mesh 
                filename="package://mecademic_description/meshes/meca_500_r3_j6_collision.stl" 
                scale="${scale} ${scale} ${scale}"    
            />
        </geometry>
    </collision>
</link>

<!--
    ******************** 
    Mecademic frame conventions 
    ********************
-->

<!-- BRF, Base Reference Frame -->
<link name="${prefix}meca_brf" />
<!-- Fixed Joint BASE_LINK->BRF -->
<joint name="${prefix}base_link-meca_brf" type="fixed">
    <parent link="${prefix}base_link" />
    <child link="${prefix}meca_brf" />
    <!-- TODO: CHECK THE origin VALUE -->
    <origin xyz="${0.012*scale} 0 0" rpy="0 0 0" />
</joint>

<!-- FRF, Flange Reference Frame -->
<link name="${prefix}meca_frf" />
<!-- Joint AXIS_6_LINK->FLANGE_REFERENCE_FRAME_LINK  -->
<joint name="${prefix}A6_link-meca_frf" type="fixed">
    <parent link="${prefix}A6_link" />
    <child link="${prefix}meca_frf" />
    <origin xyz="0 0 0" rpy="0 ${pi/2} 0" />
</joint>

<!--
    ******************** 
    ROS-I Links 
    ********************
-->

<!-- ROS-Industrial 'base' frame-->
<link name="${prefix}base" />
<joint name="${prefix}meca_brf-base" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <parent link="${prefix}meca_brf"/>
    <child link="${prefix}base"/>
</joint>


<!-- ROS-Industrial 'flange' frame: attachment point for EEF models -->
<link name="${prefix}flange" />
<joint name="${prefix}A6_link-flange" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 0" />
    <parent link="${prefix}A6_link" />
    <child link="${prefix}flange" />
</joint>

<!-- ROS-Industrial 'tool0' frame: all-zeros tool frame -->
<link name="${prefix}tool0" />
<joint name="${prefix}meca_frf-tool0" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 0" />
    <parent link="${prefix}meca_frf" />
    <child link="${prefix}tool0" />
</joint>

</xacro:macro> <!-- end meca_500_r3 macro -->

</robot>